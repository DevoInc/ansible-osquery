---
# defaults file for osquery

osquery_service_enable: true

osquery_template: 'osquery.conf.j2'
osquery_upload_packs: []
osquery_packs:
    - "osquery-monitoring"
    - "incident-response"
    - "it-compliance"
#    - "osx-attacks"
    - "vuln-management"
    - "hardware-monitoring"
osquery_flags: []
## if using zentral, kolide or else
## https://github.com/zentralopensource/zentral/blob/f460b10a95d4ea1e515aea3363f55733465d1d9c/zentral/contrib/osquery/deb_script/template.sh
## https://docs.kolide.co/kolide/current/infrastructure/adding-hosts-to-kolide.html
#osquery_flags:
#    - { re: '^--enroll_secret_env=.*', l: '--enroll_secret_env=OSQUERY_ENROLL_SECRET' }
#    - { re: '^--tls_server_certs=.*', l: '--tls_server_certs=/etc/osquery/kolide.crt' }
#    - { re: '^--tls_hostname=.*', l: '--tls_hostname=acme.kolide.co' }
#    - { re: '^--host_identifier=.*', l: '--host_identifier=hostname' }
#    - { re: '^--enroll_tls_endpoint=.*', l: '--enroll_tls_endpoint=/api/v1/osquery/enroll' }
#    - { re: '^--config_plugin=.*', l: '--config_plugin=tls' }
#    - { re: '^--config_tls_endpoint=.*', l: '--config_tls_endpoint=/api/v1/osquery/config' }
#    - { re: '^--config_tls_refresh=.*', l: '--config_tls_refresh=10' }
#    - { re: '^--disable_distributed=.*', l: '--disable_distributed=false' }
#    - { re: '^--distributed_plugin=.*', l: '--distributed_plugin=tls' }
#    - { re: '^--distributed_interval=.*', l: '--distributed_interval=10' }
#    - { re: '^--distributed_tls_max_attempts=.*', l: '--distributed_tls_max_attempts=3' }
#    - { re: '^--distributed_tls_read_endpoint=.*', l: '--distributed_tls_read_endpoint=/api/v1/osquery/distributed/read' }
#    - { re: '^--distributed_tls_write_endpoint=.*', l: '--distributed_tls_write_endpoint=/api/v1/osquery/distributed/write' }
#    - { re: '^--logger_plugin=.*', l: '--logger_plugin=tls' }
#    - { re: '^--logger_tls_endpoint=.*', l: '--logger_tls_endpoint=/api/v1/osquery/log' }
#    - { re: '^--logger_tls_period=.*', l: '--logger_tls_period=10' }

osquery_fim: true
osquery_rsyslog: false
## conflict with auditd. choose one.
## https://osquery.readthedocs.io/en/stable/deployment/process-auditing/
osquery_process_auditing: false

osquery_logrotate: true
osquery_logrotate_days: 90

osquery_syslog_target: ''
#osquery_syslog_target: '@@10.1.1.100'
## mostly for testing purpose
#osquery_syslog_target: '/var/log/osquery_syslog.log'
osquery_syslog_target_facility: 19
