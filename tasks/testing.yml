---

- meta: flush_handlers

- name: pause a bit to have few queries results
  pause:
#    minutes: 5
    seconds: 60

- block:
    - name: list services
      command: systemctl status
      changed_when: false
      ignore_errors: true
      register: svc
    - debug: var=svc
  when: ansible_os_family == "RedHat"
#  when: ansible_service_mgr == 'systemd'

- block:
    - name: systemd | check service status
      command: "systemctl status osqueryd -l"
      register: systemctl
    - debug: var=systemctl.stdout_lines
  when: ansible_service_mgr == "systemd"
- block:
    - name: service | check service status
      command: "service osqueryd status"
      register: service
    - debug: var=service.stdout_lines
  when: ansible_service_mgr != "systemd"
